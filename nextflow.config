profiles {
	sge {
		process.executor = 'sge'
		process.shell = ['/usr/bin/env', 'bash']
		process.queue = 'all.q'
		process.clusterOptions = '-V -S /bin/bash'
		process.penv = 'multislot'
	}
	slurm {
		process.executor = 'slurm'
	}
	local {
		process.executor = 'local'
	}

	singularity {
		singularity.enabled = true
		singularity.autoMounts = true
	}
	docker {
		docker.enabled = true
	}
    podman {
        podman.enabled = true
    }
}

docker {
        docker.enabled = true
        runOptions = '-u $(id -u):$(id -g)'
}

podman {
		podman.enabled = true
}

process {
	withName: 'quality_control|quality_control_2' {
		cpus = 1
		memory = '1 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/fastqc:1.0'
	}
	withName: adapter_removal {
		cpus = 1
		memory = '5 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/trim_galore:1.0'
	}
	withName: quality_filter {
		cpus = 1
		memory = '1 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/fastx:1.0'
	}
	withName: remove_exp_barcode {
		cpus = 1
		memory = '10 MB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/fastx:1.0'
	}
	withName: extract_rnd_barcode {
		cpus = 1
		memory = '1 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/umi-tools:1.0'
	}
	withName: deduplicate {
		cpus = 1
		memory = '100 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/umi-tools:1.0'
	}
	//TODO: needs checking
	withName: 'check_barcode_file|get_length_exp_barcode|merge_preprocessed_reads|get_top_hits|remove_newlines|extract_top_transcript_sequences' {
		cpus = 1
		memory = '500 MB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/base:1.0'
	//TODO: needs checking
	}
	//TODO samtools -> filter empty bam; merge deduplicate; count hits; index alignments; extract top alignments
	withName: 'merge_deduplicated_bam|count_hits|filter_empty_bams|sort_bam|index_alignments|extract_top_alignments|index_for_peak_calling' {
		cpus = 1 
		memory = '10 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/samtools:1.0'

	}
	//TODO bamtools
	withName: 'split_bam_by_chromosome' {
		cpus = 1
		memory = '500 MB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/bamtools:1.0'

	}
	//TODO: needs checking
	withName: 'merge_wigs' {
		cpus = 1 
		memory = '500 MB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/merge:1.0'

	}
	withName: split_exp_barcode {
		cpus = 1
		memory = '500 MB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/fastx:1.0'
	}
	withName: 'build_index_bowtie|mapping_bowtie' {
		cpus = 4
		memory = '500 MB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/bowtie2:1.0'
	}
	withName: 'build_index_STAR|mapping_STAR' {
		cpus = 8
		memory = '100 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/star:1.0'
	}
	withName: calculate_crosslink_sites {
		cpus = 1
		memory = '100 MB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/determine_cl_sites:1.0'
	}
	//TODO: Needs checking for resource usage
	withName: feature_counts {
		cpus = 1
		memory = '100 MB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/subread:1.0'
	}
	//TODO: needs checking
	withName: pureCLIP {
		cpus = 8
		memory = '10 GB'
		container = 'quay.io/biocontainers/pureclip:1.3.1--0'
	}
	withName: multiqc {
		cpus = 1
		memory = '10 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/multiqc:1.0'
	}
	//TODO: check resource usage
	withName: wig_to_bam {
		cpus = 1
		memory = '10 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/wig2bam:1.0'
	}
	//TODO: check resource usage
	withName: get_RNA_species_distribution{
		cpus = 1
		memory = '10 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/rna_species_distribution:1.0'
	}
	//TODO: check resource usage
	withName: generate_RNA_species_barplot{
		cpus = 1
		memory = '10 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/rna_species_barchart:1.0'
	}
	//TODO: check resource usage
	withName: sequence_extraction{
		cpus = 1
		memory = '500 MB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/peak_distance:1.0'
	}
		//TODO: check resource usage
	withName: peak_distance{
		cpus = 1
		memory = '500 MB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/sequence_extraction:1.0'
	}
	//TODO: check resource usage
	withName: generate_barcode_barplot{
		cpus = 1
		memory = '10 GB'
		container = 'harbor.computational.bio.uni-giessen.de/sjaenick/barcode_barchart:1.0'
	}
}
